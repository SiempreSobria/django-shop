{% extends 'shop/base.html' %}
{% load static %}

{% block content %}
<h2 class="mb-4">üõí –í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞</h2>

{% if cart %}
<div class="table-responsive">
  <table class="table align-middle table-bordered shadow-sm">
    <thead class="table-light">
      <tr>
        <th style="width: 80px;">–§–æ—Ç–æ</th>
        <th>–¢–æ–≤–∞—Ä</th>
        <th style="width: 120px;" class="text-center">–ö–æ–ª-–≤–æ</th>
        <th style="width: 120px;" class="text-end">–¶–µ–Ω–∞</th>
        <th style="width: 120px;" class="text-end">–°—É–º–º–∞</th>
        <th style="width: 80px;"></th>
      </tr>
    </thead>
    <tbody>

      {% for item in cart %}
      <tr id="cart-item-{{ item.product.id }}">
        
        <!-- –§–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞ -->
        <td>
          {% if item.product.image %}
            <img src="{{ item.product.image.url }}" class="img-fluid rounded" style="height:60px; width:60px; object-fit:cover;">
          {% else %}
            <img src="{% static 'shop/no_image.png' %}" class="img-fluid rounded" style="height:60px; width:60px; object-fit:cover;">
          {% endif %}
        </td>

        <!-- –ù–∞–∑–≤–∞–Ω–∏–µ -->
        <td class="fw-semibold">{{ item.product.title }}</td>

        <!-- –ö–æ–ª-–≤–æ -->
        <td class="text-center">{{ item.quantity }}</td>

        <!-- –¶–µ–Ω–∞ -->
        <td class="text-end">{{ item.price }} ‚ÇΩ</td>

        <!-- –°—É–º–º–∞ -->
        <td class="text-end fw-bold">{{ item.total_price }} ‚ÇΩ</td>

        <!-- –£–¥–∞–ª–∏—Ç—å -->
        <td class="text-center">
          <form method="post" action="{% url 'cart_remove' item.product.id %}">
            {% csrf_token %}
            <button type="submit"
                    class="btn btn-outline-danger btn-sm remove-from-cart"
                    data-product-id="{{ item.product.id }}"
                    title="–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä">
              <i class="bi bi-trash"></i>
            </button>
          </form>
        </td>
      </tr>
      {% endfor %}

      <!-- –ò—Ç–æ–≥–æ–≤—ã–µ —Å—É–º–º—ã -->
      <tr class="fw-bold table-secondary">
        <td colspan="4" class="text-end">–ò—Ç–æ–≥–æ:</td>
        <td id="cart-total-price" class="text-end">{{ cart.get_total_price }} ‚ÇΩ</td>
        <td></td>
      </tr>
      <tr class="fw-bold">
        <td colspan="4" class="text-end">–¢–æ–≤–∞—Ä–æ–≤:</td>
        <td id="cart-total-quantity" class="text-end">{{ cart.get_total_quantity }} —à—Ç.</td>
        <td></td>
      </tr>

    </tbody>
  </table>
</div>

<!-- –ö–Ω–æ–ø–∫–∏ -->
<div class="d-flex justify-content-between mt-3">
  <a href="{% url 'products_list' %}" class="btn btn-outline-secondary btn-lg">
    ‚Üê –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏
  </a>
  <a href="{% url 'order_create' %}" class="btn btn-success btn-lg">
    ‚úî –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑
  </a>
</div>

{% else %}

<!-- –ü–£–°–¢–ê–Ø –ö–û–†–ó–ò–ù–ê -->
<div class="text-center py-5">
  <img src="{% static 'shop/empty_cart.png' %}" alt="–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞" style="width:140px; opacity:.8;">
  <h4 class="mt-3">–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</h4>
  <p class="text-muted">–î–æ–±–∞–≤—å—Ç–µ —Ç–æ–≤–∞—Ä—ã –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞</p>
  <a href="{% url 'products_list' %}" class="btn btn-primary btn-lg mt-2">
    –ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥
  </a>
</div>

{% endif %}
{% endblock %}
